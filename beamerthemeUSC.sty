% this style was created by Horea Christian and is based on the ETH ZÃ¼rich corporate design color palette https://www.ethz.ch/services/en/service/communication/corporate-design/colour.html
% Adapted by Karel Mundnich <mundnich@usc.edu>. USC colors were extracted from https://identity.usc.edu/print/colors/


\ProvidesPackage{beamerthemeUSC}

% \usepackage{graphics}
\usepackage{graphicx}
\newcommand{\vcenteredinclude}[1]{\begingroup
\setbox0=\hbox{\includegraphics[width=.8\textwidth, height=.06\paperheight, keepaspectratio]{#1}}%
\parbox{\wd0}{\box0}\endgroup}


\usepackage{calc}
\newlength{\mylength}

\mode<presentation>

% Primary colors
\definecolor{Cardinal}{RGB}{153,27,30}
\definecolor{Gold}{RGB}{255,204,0}

% Secondary colors
\definecolor{Black}{HTML}{000000}  % 100% Black
\definecolor{DarkGray}{HTML}{777777} % 53% Black
\definecolor{LightGray}{HTML}{CCCCCC} % 20% Black
\definecolor{White}{HTML}{FFFFFF} % White

\definecolor{Gray}{RGB}{111,111,110}
\definecolor{tlg}{RGB}{230,230,230}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% It seems many of the following entries do not control any visible behavior. All such entries are set to red, so that they are easy to spot if they ever become visible

\setbeamercolor{headline}{fg=red,bg=Cardinal} % This is the recommended color for Specialist community usage: change to ETH1 for general communication
\setbeamercolor{footline}{fg=red, bg=red}
\setbeamerfont{footline}{size=\large,series=\bf}
\setbeamercolor{separation line}{bg=Cardinal}
\setbeamercolor{title in headline}{fg=white}
\setbeamercolor{author in headline}{fg=white}
\setbeamercolor{institute in headline}{fg=white}

\setbeamercolor{framesubtitle}{fg=red, bg=Cardinal}
\setbeamercolor{author in head/foot}{fg=white, bg=Cardinal}
\setbeamercolor{title in head/foot}{fg=red, bg=Cardinal}

\setbeamercolor*{normal text}{fg=Gray, bg=tlg}
\setbeamercolor*{block body}{fg=black, bg=white}
\setbeamercolor*{block title}{fg=black,bg=Gold}
\setbeamerfont{block title}{size=\large,series=\bf}
\setbeamercolor{upper separation line head}{fg=Cardinal}

\setbeamercolor*{example body}{fg=red,bg=red}
\setbeamercolor*{example text}{fg=red,bg=red}
\setbeamercolor*{example title}{bg=red,fg=red}

\setbeamercolor{alerted text}{fg=red}
\setbeamercolor{structure}{fg=Cardinal}

\setbeamertemplate{itemize items}{\color{Cardinal}$\blacktriangleright$}
\setbeamertemplate{navigation symbols}{}  % no navigation on a poster

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% If you want a gray scale template, uncomment these lines and comment the upper color \setbeamercolor lines

% \setbeamercolor{headline}{fg=red,bg=DarkGray} % This is the recommended color for Specialist community usage: change to ETH1 for general communication
% \setbeamercolor{footline}{fg=red, bg=red}
% \setbeamerfont{footline}{size=\large,series=\bf}
% \setbeamercolor{separation line}{bg=DarkGray}
% \setbeamercolor{title in headline}{fg=white}
% \setbeamercolor{author in headline}{fg=white}
% \setbeamercolor{institute in headline}{fg=white}

% \setbeamercolor{framesubtitle}{fg=red, bg=DarkGray}
% \setbeamercolor{author in head/foot}{fg=white, bg=DarkGray}
% \setbeamercolor{title in head/foot}{fg=red, bg=DarkGray}

% \setbeamercolor*{normal text}{fg=Gray, bg=tlg}
% \setbeamercolor*{block body}{fg=black, bg=white}
% \setbeamercolor*{block title}{fg=black,bg=LightGray}
% \setbeamerfont{block title}{size=\large,series=\bf}
% \setbeamercolor{upper separation line head}{fg=DarkGray}

% \setbeamercolor*{example body}{fg=red,bg=red}
% \setbeamercolor*{example text}{fg=red,bg=red}
% \setbeamercolor*{example title}{bg=red,fg=red}

% \setbeamercolor{alerted text}{fg=red}
% \setbeamercolor{structure}{fg=DarkGray}

% \setbeamertemplate{itemize items}{\color{DarkGray}$\blacktriangleright$}
% \setbeamertemplate{navigation symbols}{}  % no navigation on a poster

\newenvironment<>{myblock}[1]{%
	\begin{actionenv}#2%
	\def\insertblocktitle{\centering#1}%
	\par%
	\usebeamertemplate{block begin}\leftskip=14pt\rightskip=14pt\vspace{10pt}}
	{\par\vspace{1em}\usebeamertemplate{block end}
	\end{actionenv}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% !!! This environment can't both have nice margins AND display the contained text as justified:
% We preferentially use the above but keep this one just-in-case
\setbeamertemplate{block begin}{
	\setlength{\mylength}{\textwidth+2ex}%
	\vskip2ex
	\begin{beamercolorbox}[ht=2.8ex,dp=2ex, wd=\mylength, center,rounded=false,shadow=false,leftskip=1cm,colsep*=0ex]{block title}%
		\usebeamerfont*{block title}\centering \insertblocktitle
	\end{beamercolorbox}\vskip-9pt%
	{\ifbeamercolorempty[bg]{block body}{}{\nointerlineskip\vskip-0.5ex}}%
	\usebeamerfont{block body}%
	\begin{beamercolorbox}[rounded=false,shadow=false,center,wd=\textwidth,]{block body}%
		\ifbeamercolorempty[bg]{block body}\vbox{}%
		\begin{minipage}{0.96\textwidth}\vbox{}%
		\justify
		}
\setbeamertemplate{block end}{
	\end{minipage}
	\end{beamercolorbox}
	}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setbeamertemplate{headline}{
	\leavevmode
	\begin{beamercolorbox}[wd=\paperwidth]{headline}
		\vspace{2ex}\\
		\begin{columns}[c]
			\begin{column}{.09\paperwidth}
			\end{column}
			\begin{column}{.675\paperwidth}
				\raggedleft
				\usebeamercolor{title in headline}{\color{fg}\textbf{\LARGE{\inserttitle}}\\[1ex]}
				\usebeamercolor{author in headline}{\color{fg}\large{\insertauthor}\\[1ex]}
				\usebeamercolor{institute in headline}{\color{fg}\small{\insertinstitute}\\[1ex]}
			\end{column}
			\begin{column}{.25\paperwidth}
				\begin{figure}
					\centering
					\begin{minipage}{\textwidth}
						\centering
						\vspace{-0.5cm}				
						\includegraphics{img/USCtransLogo}						
					\end{minipage}
					\begin{minipage}{\textwidth}
						\centering
						\vspace{-1cm}
						\includegraphics[width=0.5\textwidth, keepaspectratio]{img/saillogotransparent.png}						
					\end{minipage}
				\end{figure}
			\end{column}
			\begin{column}{.03\paperwidth}
			\end{column}
		\end{columns}
		\vspace{2ex}\\
	\end{beamercolorbox}

 	\begin{beamercolorbox}[wd=\paperwidth]{lower separation line head}
		\rule{0pt}{2pt}
	\end{beamercolorbox}
	\vskip-2cm
	}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setbeamertemplate{footline}{
	\begin{beamercolorbox}[wd=\paperwidth]{upper separation line foot}
		\rule{0pt}{2pt}
	\end{beamercolorbox}
	\leavevmode%
	\begin{beamercolorbox}[ht=4ex,leftskip=1cm,rightskip=1cm]{author in head/foot}%
		\href{http://sail.usc.edu}{sail.usc.edu}
		\hfill
		\today
		\hfill
		\href{mailto:mundnich@usc.edu}{mundnich@usc.edu}
		\vskip1ex
	\end{beamercolorbox}
	\vskip0pt%
	\begin{beamercolorbox}[wd=\paperwidth]{lower separation line foot}
		\rule{0pt}{2pt}
	\end{beamercolorbox}
	}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Display a grid to help align images ... and it looks nice with this color scheme
% \beamertemplategridbackground[1cm]

%Some beamer customizations:
\setbeamertemplate{bibliography item}[text]
\setbeamertemplate{caption}[numbered]{}% Number float-like environments

\mode<all>
